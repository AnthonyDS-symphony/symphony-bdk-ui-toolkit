import DataGrid from '.';
import Box from '../../layout/box';
import Text from '../../misc/text';
import { GridHandler, GridWithError } from './samples/grid-components';
import {
  Story,
  Meta,
  Preview,
  Props,
  Link
} from "@storybook/addon-docs/blocks";

<Meta title="components/Data/Data Grid" component={DataGrid} />

# DataGrid

<hr />

An Excel-like grid component, that wraps the basic functionalities of
https://adazzle.github.io/react-data-grid/, but includes the Toolkit's own styling and Components.

To facilitate use, the ```data``` prop has been created, and it will act the same way the Table component does, rather than passing in a ```rowGetter```.

Please for further customization please follow the above documentation,
everything passed to DataGrid will be propagated and **override** any prop.

<Preview withSource="none">
  <Story name="Base">
    <Box type="primary" style={{ padding: '0px 100px', width: '100%' }}>
      <GridHandler />
    </Box>
  </Story>
</Preview>

For the example above, the controller component for it is:
```jsx
const DATA = [{
  email: '4@domain.com',
  name: 'A',
  link: 'http://a.com',
  rowId: 1,
}, {
  email: '3@domain.com',
  name: 'B',
  link: 'http://b.com',
  rowId: 2,
}, {
  email: '2@domain.com',
  name: 'C',
  link: 'http://c.com',
  rowId: 3,
}, {
  email: '1@domain.com',
  name: 'D',
  link: 'http://d.com',
  rowId: 4,
}];

const COLUMNS = [{
  name: 'Name',
  key: 'name',
  editable: true,
}, {
  name: 'Email',
  key: 'email',
  editable: true,
  tooltip: 'A grand set of details about this column. You can edit it too!',
}, {
  name: 'Link',
  key: 'link',
  editable: true,
}];

export const GridHandler = () => {
  const [list, setList] = useState(DATA);
  const onGridRowsUpdated = ({ fromRow, toRow, updated }) => {
    // update based on invite list
    const updatedList = [...list];

    for (let row = fromRow; row <= toRow; row++) {
      // get rowId from row at "display list"
      const { rowId } = list[row];

      // update using rowId
      const index = updatedList.findIndex(row => row.rowId === rowId);
      updatedList[index] = { ...list[index], ...updated };
    }
    setList(updatedList);
  };

  return (
    <DataGrid
      columns={COLUMNS}
      data={list}
      enableCellSelect
      rowGetter={row => list[row]}
      onGridRowsUpdated={onGridRowsUpdated}
    />
  );
};
```

## ```rowGetter``` Sample
```jsx
const columns = [{
  name: 'Name',
  key: 'name',
  editable: true,
}, {
  name: 'Email',
  key: 'email',
  editable: true,
}, {
  name: 'Link',
  key: 'link',
  editable: true,
}];

return (<DataGrid
  columns={columns}
  rowGetter={row => data[row]}
/>);
```

## ```data``` Sample
```jsx
const data = [{
  email: '4@domain.com',
  name: 'A',
  link: 'http://a.com',
  rowId: 1,
}, {
   email: '4@domain.com',
  name: 'A',
  error: { email: true },
  link: 'http://a.com',
  rowId: 2,
}, {
  email: '4@domain.com',
  name: 'A',
  link: 'http://a.com',
  rowId: 3,
}];

return (<DataGrid
  columns={columns}
  data={data}
/>);
```

## Custom cell handler Sample
```jsx
const columns = [{
  name: 'Name',
  key: 'name',
  editable: true,
}, {
  name: 'Email',
  key: 'email',
  editable: true,
}, {
  name: 'Link',
  key: 'link',
  editable: true,
  formatter: row => (<a href={row.value}>{row.value}</a>),
}];

return (<DataGrid
  columns={columns}
  data={data}
/>);
```

## Example with Error

<Preview withSource="none">
  <Story name="With Error">
    <Box type="primary" style={{ padding: '0px 100px', width: '100%' }}>
      <GridWithError />
    </Box>
  </Story>
</Preview>

<Props of={DataGrid} />
